# Recommending_Movie_with_Emotions
## Group Project on GDGoC (AIOps)

# #1 주제

**사용자 감정에 따른 영화 추천**

# #2 구체화

## #2.1 감정

감정을 어떻게 판단할 것인가?

⇒ 사용자가 가장 솔직히 자신의 감정을 표현해내는 곳은 어디인가?

⇒ 옛날에 생각해보면 일기 쓸 때 자신의 속마음을 가장 솔직히 표현한 곳은 일기였음.

<aside>
💡

**일기(text)를 통해 감정의 정도를 수치로 표현하면 좋겠다!**

⇒ Hugging Face API를 사용해서 감정을 도출

</aside>

## #2.2 영화

영화와 감정을 어떻게 매칭시킬 것인가? 그 근거를 뭘로 잡을까?

<aside>
💡

**⇒ Hypothesis1 : 어떤 영화에 대한 리뷰에는 그 영화를 보고 난 뒤의 감정이 들어갈 것이다**

⇒ **Hypothesis2 : 영화의 장르는, 영화의 감정을 어느 정도 품을 것이다.**

</aside>

⇒**kaggle**에서 영화와 그에 대한 감정을 담은 Dataset 검색

⇒ 약 350편의 영화들에 대해, 각 장르를 담고, 총 2만개에 달하는 리뷰 데이터셋 찾음.

## #2.3 시스템 구성

### #2.3.1 Train 과정 구성

![image.png](Presentation/image.png)

1. 데이터 전처리
    
    한 영화에 중복된 리뷰들도 많았고, 우리의 시스템에 필요없는 데이터들도 많아서 다음을 진행
    
    - 중복 제거
    - 필요없는 특징들(제조사, 감독 등) 제거

1. model1(텍스트 → 감정)
    
    프로토타입으로 만들다보니, 감정의 개수를 4개로 단순화,
    
    - joy(즐거움)
    - optimism(낙천적)
    - anger(화)
    - sadness(슬픔)
    
    Embedding 모델로 감정 벡터를 만들어냄.
    
    Hugging Face API를 가져다 썼고, 구체적으로는
    
    <aside>
    💡
    
     https://huggingface.co/cardiffnlp/twitter-roberta-base-emotion
    
    </aside>
    
    위를 사용함.
    
    <aside>
    💡
    
    헤어질 결심을 보고 작성한 **리뷰**에 대해서는 다음과 같은 감정 벡터가 model1에서 도출됨
    
    [  0.1       0.2        0.2      0.5 ]
    
    [joy  optimisim   anger  sad ]
    
    </aside>
    
2. **model2(감정 → 영화 장르)**
    
    model2에서는 model1에서 결과로 나온 감정 벡터를 model2의 input으로 사용.
    
    그리고 model2는 해당 감정 벡터를 입력으로 한 예측에서 각 장르별 확률을 도출해냄.
    
    **Regularizaiton은 진행되지 않았음**. 하지 않은 이유는 라벨의 특성 때문에 그랬음.
    
    **⇒ 한 영화의 장르는 여러 개가 존재할 수 있음.** 이런 점을 잃고 싶지 않아서 각 장르일 확률을 도출.
    
    <aside>
    💡
    
    즉, **헤어진 결심**이란 영화의 장르가 로맨스, 스릴러, 미스테리 일 경우,
    
    정답인 Label은 다음과 같이 구성
    
    [    1           0           1          1          …    0     ]
    
    [로맨스  코미디   스릴러  미스테리    …   공포 ]
    
    model2의 예측은 아래와 같이 구성됨.
    
    [    0.5     0.05        0.5         0.3      …    0.05 ]
    
    [로맨스  코미디   스릴러  미스테리    …   공포 ]
    
    </aside>
    
    **이 부분 구성을 맡음.**
    
    하드 코딩으로 진행했고, 기계 학습 강의때 배운 내용과 googling 바탕으로 짰고, 최대한 OOP스럽게 짜고 싶었음. 
    
    모듈화 해서, 여러 값으로 진행할 수도 있게.
    
    https://github.com/jeonbyoung/Recommending_Movie_with_Emotions/blob/main/model2.py
    
    사실 이 모델을
    
    - MLP와 RandomForest 두 방법을 다 사용하고 싶었음
    - train이 끝나는 지점도 명확히 구성하고 싶었는데, 그냥 모든 epoch를 다 돌게 만듦.
    
    시간적 여유가 없길래 나중을 도모…
    
    각 은닉층에 대해 다른 activation function을 사용하는 방식으로 짜고 싶었는데, back propagation 식 짜고 하는데 거기까지 생각이 도달하지 못 함. 이것도 추후에 고쳐봐야겠음.
    
    Googling하다가 Xavier, He 초기화를 공부하기도 했음. 이를 코드에 간단히 적용시켜 보았고, 공부 내용은 #3에 올려놓았음.
    

### #2.3.2 Recommending 과정 구성

![image.png](Presentation/image%201.png)

사용자가 일기를 입력할 때마다 계속 model1과 model2를 따로 돌리는 것은 굉장히 비효율적임.

<aside>
💡

train_model.py를 구성해서 미리 한 번씩 돌려놓음

1. model1은 원본 데이터셋을 돌려서 csv파일을 미리 준비해놓고
2. model2는 그 csv파일을 가지고 미리 학습을 진행하고, 학습이 완료됐을 때의 가중치 값을 pickle파일에 저장. 후에 recommending때 학습 없이 바로 쓸 수 있게.
</aside>

이후 위 그림처럼 진행하고, 전처리 완료된 데이터셋의 label 값들이랑 cosine 유사도 검사해서 3순위까지 추천.

# #3 결과

![image.png](Presentation/image%202.png)

# #4 감상 & Next_step

## #4.1 감상

같이 하는 프로젝트가 처음이다 보니, 어려운 점이 많았음.

아이디어 구상하고, 정리하는 과정에서 communication이 중요함을 알았음.

제일 중요한 건 AI에 기대지 않는 것, 내가 제대로 모르는 것을 “Gemini가 된다는데?”라는 식으로 말하는 것이 얼마나 의미없는 말인지 깨닫고, 더 많이 공부할 수 있는 계기가 되었음.

내가 구상한 아이디어가 실제로 작동하는 것을 보니, 이 분야에 조금 더 흥미를 가지게 된 것 같음.

## #4.2 Next_step

- **코드 통합 완료**
    
    model1과 model2를 따로 짜다보니, main.py, train_model.py에서 뭔가 안 맞는 문제가 생겼음.
    
    따로 따로 돌려서 model1의 결과를 가지고 model2를 돌린 뒤, 추천을 진행하는 것은 되고, 위 결과가 그 도출물.
    
    hugging face라는 큰 애랑 큰 데이터셋을 cpu로 돌릴려니, 쉽지 않아 colab에서 돌리려 했는데, 이때는 hugging face API가 막혀서 코드를 통합해도, 시간이 오래 걸릴 것 같아 나중을 도모함.
    
- **유저 피드백 파이프라인 구축**
- **더 많은 데이터셋 확보**
    
    한국 영화가 하나도 없음. 이에 대한 데이터셋도 나중에 확보해서 보충.
    
- **model2 세분화**
    
    MSE말고, BCE도 써보고. 랜덤포레스트도 써보고, 각 레이어 별로 활성함수도 다른 것을 넣을 수 있게 짜보고 싶음.
    
- **모듈화된 것을 통해, 영화 말고 다른 것을 추천하는 것도 확보**
    
    이를 테면 음악 추천이라든지… 음악 추천이라든지… 음악 추천이라든지… 음악 추천이라든지… 음악 추천이라든지… 음악 추천이라든지… 
    
    spotify API를 통해 음악 추천을 하고 싶었는데, 24년 11월부로 spotify에서 막아서 못 함.
    
- **실제 서비스에 올리기**
    
    실제 추천할 수 있는 게 여러 개 되면, 이를 일기 작성 앱같은 곳에 요청해서 올려보고 실제로 사람들이 어떻게 반응도 보고 싶음.
